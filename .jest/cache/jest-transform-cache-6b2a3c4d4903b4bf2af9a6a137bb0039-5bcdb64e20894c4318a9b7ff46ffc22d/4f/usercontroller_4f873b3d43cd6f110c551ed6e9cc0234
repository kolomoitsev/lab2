e8f57ad0424d2b73bcd7a19102f5d1f9
"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.UserController = void 0;
const userModel = require('./../models/user.model');
const bCrypt = require('bcrypt');
class UserController {
    findUser(userEmail) {
        return __awaiter(this, void 0, void 0, function* () {
            return userModel.findOne({
                userEmail
            });
        });
    }
    ;
    changePassword(opts) {
        return __awaiter(this, void 0, void 0, function* () {
            return userModel.findOneAndUpdate({
                userEmail: opts.userEmail
            }, {
                userPassword: yield bCrypt.hash(opts.userPassword, 10)
            })
                .select('-userPassword');
        });
    }
    getAll() {
        return __awaiter(this, void 0, void 0, function* () {
            return userModel.find({})
                .select('-userPassword');
        });
    }
    refreshToken() {
        return __awaiter(this, void 0, void 0, function* () {
        });
    }
    register(opts) {
        return __awaiter(this, void 0, void 0, function* () {
            let user = new userModel({
                userName: opts.userName,
                userLastName: opts.userLastName,
                userEmail: opts.userEmail,
                userPhone: opts.userPhone,
                userPassword: yield bCrypt.hash(opts.userPassword, 10)
            });
            yield user.save();
            user = user.toObject();
            delete user.userPassword;
            return user;
        });
    }
}
exports.UserController = UserController;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2FwcGxlL0Rlc2t0b3AvcGVyc29uYWwvdW5pL3Rlc3RpbmcvbGFiMi9zcmMvY29udHJvbGxlcnMvdXNlci5jb250cm9sbGVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUVBLE1BQU0sU0FBUyxHQUFHLE9BQU8sQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO0FBQ3BELE1BQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQztBQVdqQyxNQUFhLGNBQWM7SUFDVixRQUFRLENBQUMsU0FBaUI7O1lBQ25DLE9BQU8sU0FBUyxDQUFDLE9BQU8sQ0FBQztnQkFDckIsU0FBUzthQUNaLENBQUMsQ0FBQztRQUNQLENBQUM7S0FBQTtJQUFBLENBQUM7SUFFVyxjQUFjLENBQUMsSUFBcUI7O1lBQzdDLE9BQU8sU0FBUyxDQUFDLGdCQUFnQixDQUFDO2dCQUM5QixTQUFTLEVBQUUsSUFBSSxDQUFDLFNBQVM7YUFDNUIsRUFBRTtnQkFDQyxZQUFZLEVBQUUsTUFBTSxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxZQUFZLEVBQUUsRUFBRSxDQUFDO2FBQ3pELENBQUM7aUJBQ0csTUFBTSxDQUFDLGVBQWUsQ0FBQyxDQUFDO1FBRWpDLENBQUM7S0FBQTtJQUVZLE1BQU07O1lBQ2YsT0FBTyxTQUFTLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQztpQkFDcEIsTUFBTSxDQUFDLGVBQWUsQ0FBQyxDQUFDO1FBQ2pDLENBQUM7S0FBQTtJQUVZLFlBQVk7O1FBRXpCLENBQUM7S0FBQTtJQUVZLFFBQVEsQ0FBQyxJQUFXOztZQUU3QixJQUFJLElBQUksR0FBRyxJQUFJLFNBQVMsQ0FBQztnQkFDckIsUUFBUSxFQUFFLElBQUksQ0FBQyxRQUFRO2dCQUN2QixZQUFZLEVBQUUsSUFBSSxDQUFDLFlBQVk7Z0JBQy9CLFNBQVMsRUFBRSxJQUFJLENBQUMsU0FBUztnQkFDekIsU0FBUyxFQUFFLElBQUksQ0FBQyxTQUFTO2dCQUN6QixZQUFZLEVBQUUsTUFBTSxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxZQUFZLEVBQUUsRUFBRSxDQUFDO2FBQ3pELENBQUMsQ0FBQztZQUVILE1BQU0sSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO1lBQ2xCLElBQUksR0FBRyxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7WUFFdkIsT0FBTyxJQUFJLENBQUMsWUFBWSxDQUFDO1lBQ3pCLE9BQU8sSUFBSSxDQUFDO1FBQ2hCLENBQUM7S0FBQTtDQUNKO0FBMUNELHdDQTBDQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvYXBwbGUvRGVza3RvcC9wZXJzb25hbC91bmkvdGVzdGluZy9sYWIyL3NyYy9jb250cm9sbGVycy91c2VyLmNvbnRyb2xsZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSUNoYW5nZVBhc3N3b3JkLCBJVXNlciB9IGZyb20gJy4uL3R5cGVzL3VzZXIudHlwZXMnO1xuXG5jb25zdCB1c2VyTW9kZWwgPSByZXF1aXJlKCcuLy4uL21vZGVscy91c2VyLm1vZGVsJyk7XG5jb25zdCBiQ3J5cHQgPSByZXF1aXJlKCdiY3J5cHQnKTtcblxuXG5pbnRlcmZhY2UgSVVzZXJDb250cm9sbGVyIHtcbiAgICBmaW5kVXNlcjogKHVzZXJFbWFpbDogc3RyaW5nKSA9PiBQcm9taXNlPElVc2VyPjtcbiAgICByZWZyZXNoVG9rZW46ICgpID0+IHZvaWQ7XG4gICAgcmVnaXN0ZXI6IChvcHRzOiBJVXNlcikgPT4gUHJvbWlzZTxJVXNlcj47XG4gICAgZ2V0QWxsOiAoKSA9PiBQcm9taXNlPEFycmF5PElVc2VyPj47XG4gICAgY2hhbmdlUGFzc3dvcmQ6IChvcHRzOiBJQ2hhbmdlUGFzc3dvcmQpID0+IFByb21pc2U8SVVzZXI+O1xufVxuXG5leHBvcnQgY2xhc3MgVXNlckNvbnRyb2xsZXIgaW1wbGVtZW50cyBJVXNlckNvbnRyb2xsZXIge1xuICAgIHB1YmxpYyBhc3luYyBmaW5kVXNlcih1c2VyRW1haWw6IHN0cmluZyk6IFByb21pc2U8SVVzZXI+IHtcbiAgICAgICAgcmV0dXJuIHVzZXJNb2RlbC5maW5kT25lKHtcbiAgICAgICAgICAgIHVzZXJFbWFpbFxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHVibGljIGFzeW5jIGNoYW5nZVBhc3N3b3JkKG9wdHM6IElDaGFuZ2VQYXNzd29yZCk6IFByb21pc2U8SVVzZXI+IHtcbiAgICAgICAgcmV0dXJuIHVzZXJNb2RlbC5maW5kT25lQW5kVXBkYXRlKHtcbiAgICAgICAgICAgIHVzZXJFbWFpbDogb3B0cy51c2VyRW1haWxcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgdXNlclBhc3N3b3JkOiBhd2FpdCBiQ3J5cHQuaGFzaChvcHRzLnVzZXJQYXNzd29yZCwgMTApXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc2VsZWN0KCctdXNlclBhc3N3b3JkJyk7XG5cbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgZ2V0QWxsKCk6IFByb21pc2U8QXJyYXk8SVVzZXI+PiB7XG4gICAgICAgIHJldHVybiB1c2VyTW9kZWwuZmluZCh7fSlcbiAgICAgICAgICAgIC5zZWxlY3QoJy11c2VyUGFzc3dvcmQnKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgcmVmcmVzaFRva2VuKCk6IFByb21pc2U8dm9pZD4ge1xuXG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIHJlZ2lzdGVyKG9wdHM6IElVc2VyKTogUHJvbWlzZTxJVXNlcj4ge1xuXG4gICAgICAgIGxldCB1c2VyID0gbmV3IHVzZXJNb2RlbCh7XG4gICAgICAgICAgICB1c2VyTmFtZTogb3B0cy51c2VyTmFtZSxcbiAgICAgICAgICAgIHVzZXJMYXN0TmFtZTogb3B0cy51c2VyTGFzdE5hbWUsXG4gICAgICAgICAgICB1c2VyRW1haWw6IG9wdHMudXNlckVtYWlsLFxuICAgICAgICAgICAgdXNlclBob25lOiBvcHRzLnVzZXJQaG9uZSxcbiAgICAgICAgICAgIHVzZXJQYXNzd29yZDogYXdhaXQgYkNyeXB0Lmhhc2gob3B0cy51c2VyUGFzc3dvcmQsIDEwKVxuICAgICAgICB9KTtcblxuICAgICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcbiAgICAgICAgdXNlciA9IHVzZXIudG9PYmplY3QoKTtcblxuICAgICAgICBkZWxldGUgdXNlci51c2VyUGFzc3dvcmQ7XG4gICAgICAgIHJldHVybiB1c2VyO1xuICAgIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==